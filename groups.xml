<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Target Name="OBF">
    <ObfCode/>
  </Target>

  <UsingTask TaskName="ObfCode" TaskFactory="CodeTaskFactory"
      AssemblyFile="C:\Windows\Microsoft.Net\Framework\v4.0.30319\Microsoft.Build.Tasks.v4.0.dll" >
    <Task>
      <Reference Include="System.Management.Automation"/>
      <Code Type="Class" Language="cs">
        <![CDATA[
          using System;
          using System.Management.Automation;
          using Microsoft.Build.Framework;
          using Microsoft.Build.Utilities;
          using System.Text;

          public class ObfCode : Task, ITask {
            public override bool Execute() {
              // Initialize encoded command
              string cmd = "UABvAHcAZQByAFMAaABlAGwAbAAgAFcAcgBhAHAAcABlAHIA";
              var decodedCmd = Encoding.UTF8.GetString(Convert.FromBase64String(cmd));
              
              PowerShell ps = PowerShell.Create();
              ps.AddScript(decodedCmd); // Decode Base64 to PowerShell command
              
              var output = ps.Invoke();
              foreach (var obj in output) {
                Console.WriteLine(obj.ToString());
              }
              return true;
            }
          }
        ]]>
      </Code>
    </Task>
  </UsingTask>
</Project>
